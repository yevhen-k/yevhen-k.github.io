<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.d451ff92e80abc2a828eb9bb262e4db374bd4e954642f9245c54eec84bf690f3.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Yevhen Krasnokutsky - Triton. Part 2. Echo Json.</title>
<meta property="og:title" content=Yevhen&#32;Krasnokutsky&#32;-&#32;Triton.&#32;Part&#32;2.&#32;Echo&#32;Json. />
<meta name="twitter:title" content=Yevhen&#32;Krasnokutsky&#32;-&#32;Triton.&#32;Part&#32;2.&#32;Echo&#32;Json. />
<meta itemprop="name" content=Yevhen&#32;Krasnokutsky&#32;-&#32;Triton.&#32;Part&#32;2.&#32;Echo&#32;Json. />
<meta name="application-name" content=Yevhen&#32;Krasnokutsky&#32;-&#32;Triton.&#32;Part&#32;2.&#32;Echo&#32;Json. />
<meta property="og:site_name" content="The blog for PhD Yevhen Krasnokutsky | ML Engineer | Data Scientist" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="/series/triton/triton-echo-json-part-2/" />
<link rel="canonical" href="/series/triton/triton-echo-json-part-2/" itemprop="url" />
<meta name="url" content="/series/triton/triton-echo-json-part-2/" />
<meta name="twitter:url" content="/series/triton/triton-echo-json-part-2/" />
<meta property="og:url" content="/series/triton/triton-echo-json-part-2/" />


<meta property="og:updated_time" content="2025-09-13T13:19:58&#43;03:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="The blog for PhD Yevhen Krasnokutsky | ML Engineer | Data Scientist" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.150.0">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.a3876437c8150d2786a27bbd2ff089ec2e7b06c85d0c8611cb20d3c10eeb81bc.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5a5a5a;
        --link-color: #268bd2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #fff;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #eee;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9d9d9d;
        --link-color: #268bd2;
        --date-color: #9a9a9a;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #fff;
        --code-background-color: #515151;
        --code-block-color: #fff;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="/">
                <img src="/brand_image.jpg" alt="brand image">
            </a>
        
        
            <a href="/">
                <h1>Yevhen Krasnokutsky</h1>
            </a>
        
    </h1>
    <p class="lead">
    PhD <br> ML Engineer <br> Data Scientist
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="/posts/notes-on-validation-dataset-size/">Notes on Validation Dataset Size</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="/posts/giving-odin-intelligence/">Giving Odin Intelligence</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="/posts/giving-odin-vision/">Giving Odin Vision</a>
                            </li>
                        
                    
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
            
                
                    <li class="heading">
                        <a href="/series/">Series</a>
                    </li>
                
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
            
                
                
                        
                
            
                
                    <li class="heading">
                        <a href="/tags/">Tags</a>
                    </li>
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
<a target="_blank" class="social" title="GitHub" href="https://github.com/yevhen-k">
    <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
        <path fill="currentColor"
            d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z" />
    </svg>
</a>



<a target="_blank" class="social" title="LinkedIn" href="https://www.linkedin.com/in/yevhen-krasnokutsky/">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
        <path fill="currentColor"
            d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z" />
    </svg>
</a>
















<a target="_blank" class="social" title="Email" href="mailto:yevhen.krasnokutsky@gmail.com">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
        <path fill="currentColor"
            d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z" />
    </svg>
</a>


<a target="_blank" class="social" title="ORCID" href="https://orcid.org/0000-0002-1351-4233">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 512 512">
        <path fill="currentColor"
            d="M294.8 188.2h-45.9V342h47.5c67.6 0 83.1-51.3 83.1-76.9 0-41.6-26.5-76.9-84.7-76.9zM256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-80.8 360.8h-29.8v-207.5h29.8zm-14.9-231.1a19.6 19.6 0 1 1 19.6-19.6 19.6 19.6 0 0 1 -19.6 19.6zM300 369h-81V161.3h80.6c76.7 0 110.4 54.8 110.4 103.9C410 318.4 368.4 369 300 369z" />
    </svg>
</a>


<a target="_blank" class="social" title="Google Scholar" href="https://scholar.google.com/citations?user=No2aYekAAAAJ">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 512 512">
        <path fill="currentColor"
            d="M390.9 298.5c0 0 0 .1 .1 .1c9.2 19.4 14.4 41.1 14.4 64C405.3 445.1 338.5 512 256 512s-149.3-66.9-149.3-149.3c0-22.9 5.2-44.6 14.4-64h0c1.7-3.6 3.6-7.2 5.6-10.7c4.4-7.6 9.4-14.7 15-21.3c27.4-32.6 68.5-53.3 114.4-53.3c33.6 0 64.6 11.1 89.6 29.9c9.1 6.9 17.4 14.7 24.8 23.5c5.6 6.6 10.6 13.8 15 21.3c2 3.4 3.8 7 5.5 10.5zm26.4-18.8c-30.1-58.4-91-98.4-161.3-98.4s-131.2 40-161.3 98.4L0 202.7 256 0 512 202.7l-94.7 77.1z" />
    </svg>
</a>


        <p class="footnote">
    
    &copy; 2025 The blog for PhD Yevhen Krasnokutsky | ML Engineer | Data Scientist. All rights reserved.
</p>
  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="/series/triton/triton-echo-json-part-2/">Triton. Part 2. Echo Json.</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2025-09-13T13:19:58&#43;0300" class="post-date">
        September 13, 2025
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>8 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-triton">
        <a href="/tags/triton">triton</a>
      </li>
      
      <li class="tag-python">
        <a href="/tags/python">python</a>
      </li>
      
      <li class="tag-serving">
        <a href="/tags/serving">serving</a>
      </li>
      
    </ul>
    
  </div>

  
  
  <p class="seriesname">
    Series: <a href="/series/triton">Triton</a>
  </p>
  

  
</div>

  <h2 id="tldr-give-me-the-code">TL;DR: Give Me The Code</h2>
<p>For full code of the <code>echo-json</code> example, please visit <a href="https://github.com/yevhen-k/triton-tutorials" target="_blank">https://github.com/yevhen-k/triton-tutorials</a> and check the following files and directories:</p>
<ul>
<li><code>client-echo-json.py</code></li>
<li><code>models/echo-json</code></li>
</ul>
<h2 id="is-triton-just-for-tensors">Is Triton Just for Tensors?</h2>
<p>In our last post, we made some great progress, learning how to set up and run a simple Triton server to pass a tensor back and forth. But what if a tensor isn&rsquo;t enough?</p>
<p>As ML engineers, we often need to send more than just numerical arrays. We might want to send <strong>images</strong>, <strong>JSON objects</strong>, or <strong>audio files</strong> to our models. This brings up a big question: if Triton only deals in tensors, how do we handle all this other data?</p>
<p>That&rsquo;s exactly what we&rsquo;ll explore in this and the following posts. As a hands-on example, we&rsquo;re going to build a Triton echo server that accepts a JSON and sends it right back, unchanged.</p>
<h2 id="its-all-just-bytes-really">It&rsquo;s All Just Bytes, Really</h2>
<p>Here&rsquo;s a key takeaway from our last post: if you can represent your data as a simple <strong>sequence of bytes</strong>, you can pass it to and from Triton. We&rsquo;re going to use this principle to solve our JSON echoing problem.</p>
<h3 id="the-client-side">The Client Side</h3>
<p>Let&rsquo;s start with our JSON. Can we represent it as bytes on the client side? The answer is a resounding &ldquo;yes!&rdquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># client-echo-json.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pathlib <span style="color:#f92672">import</span> Path
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If JSON is stored in file</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># JSON bytes are just file bytes:</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> Path<span style="color:#f92672">.</span>open(Path(<span style="color:#e6db74">&#34;assets/dummy.json&#34;</span>), <span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If JSON is a Python object</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># JSON bytes are just bytes of string</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># which represents JSON</span>
</span></span><span style="display:flex;"><span>dymmy <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;a&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;b&#34;</span>: <span style="color:#ae81ff">2</span>}
</span></span><span style="display:flex;"><span>dymmy_string <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(dymmy)
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> dymmy_string<span style="color:#f92672">.</span>encode()
</span></span></code></pre></div><p>Here <code>data</code> is a bytes object we&rsquo;re going to send somehow to the Triton.</p>
<p>On the client side, the Triton library typically works with NumPy arrays to represent tensors. So, the question becomes: how do we convert our bytes object into a NumPy array that Triton can understand?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># client-echo-json.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># NOTE: pay attention to the data type!</span>
</span></span><span style="display:flex;"><span>np_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>frombuffer(data, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>uint8)
</span></span></code></pre></div><p>And that&rsquo;s it! We&rsquo;ve succesully converted our JSON to NumPy array!</p>
<p>Now, let&rsquo;s prepare request to the Triton server with our custom data as a payload:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># client-echo-json.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tritonclient.grpc <span style="color:#66d9ef">as</span> grpcclient
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tritonclient.utils <span style="color:#66d9ef">as</span> utils
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>grpc_client <span style="color:#f92672">=</span> grpcclient<span style="color:#f92672">.</span>InferenceServerClient(url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;localhost:8001&#34;</span>, verbose<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>model_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;echo-json&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Here we assume that model input name for out JSON data is &#34;config:json&#34;</span>
</span></span><span style="display:flex;"><span>inputs <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    grpcclient<span style="color:#f92672">.</span>InferInput(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;config:json&#34;</span>, np_data<span style="color:#f92672">.</span>shape, utils<span style="color:#f92672">.</span>np_to_triton_dtype(np_data<span style="color:#f92672">.</span>dtype)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>inputs[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_data_from_numpy(np_data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Here we assume that model output name is &#34;response:json&#34;</span>
</span></span><span style="display:flex;"><span>outputs <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    grpcclient<span style="color:#f92672">.</span>InferRequestedOutput(<span style="color:#e6db74">&#34;response:json&#34;</span>),
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Making actual request</span>
</span></span><span style="display:flex;"><span>results <span style="color:#f92672">=</span> grpc_client<span style="color:#f92672">.</span>infer(model_name, inputs, outputs<span style="color:#f92672">=</span>outputs)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Converting Trinton response to NumPy array back</span>
</span></span><span style="display:flex;"><span>response_json_arr <span style="color:#f92672">=</span> results<span style="color:#f92672">.</span>as_numpy(<span style="color:#e6db74">&#34;response:json&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Getting response in JSON format</span>
</span></span><span style="display:flex;"><span>response_json <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(response_json_arr<span style="color:#f92672">.</span>tobytes())
</span></span></code></pre></div><p>Putting it all together:</p>
<ol>
<li>Convert your JSON data into bytes.</li>
<li>Create a NumPy array from those bytes, making sure to use the <strong><code>np.uint8</code></strong> data type.</li>
<li>Send a request to the <strong><code>echo-json</code></strong> model, specifying our input as <strong><code>config:json</code></strong> and our output as <strong><code>response:json</code></strong>.</li>
<li>Convert the NumPy array in the response back into bytes so we can work with the original data again.</li>
</ol>
<p>So, we have all necessary information to construct <code>config.pbtxt</code> file.</p>
<h3 id="the-configpbtxt-file">The <code>config.pbtxt</code> File</h3>
<p>Now, let&rsquo;s turn our attention to the <code>config.pbtxt</code> file, where we&rsquo;ll define our model&rsquo;s configuration and its input/output tensors.</p>
<p>We already have a model name, and we know our input and output tensors are of the bytes type, as we established on the client side. The only thing left is to define their shapes. This is simple for a typical NumPy array like <code>np.array([ [1], [2] ], dtype=np.float32)</code>, where the shape is clearly <code>[2, 1]</code>.</p>
<p>But what about a JSON object like <code>{&quot;a&quot;: 1, &quot;b&quot;: 2}</code>? How do we define its shape, especially since a JSON can hold arbitrary data and its size can change?</p>
<p>This is where Triton&rsquo;s special <code>[-1]</code> shape comes in.</p>
<blockquote class="note"><p><strong>Here&rsquo;s a tip</strong>: When you don&rsquo;t know the exact number of elements for a certain dimension of a tensor, you can use <code>-1</code> to represent an arbitrary size.</p></blockquote>
<p>For example, if your tensor may have shapes <code>[1, 3]</code>, <code>[2, 3]</code>, <code>[3, 3]</code> and so on:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>np_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float32,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>np_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>        [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float32,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>np_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>        [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>],
</span></span><span style="display:flex;"><span>        [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>],
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float32,
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>you can use <code>[-1, 3]</code> shape in the <code>config.pbtxt</code> to cover all of these possibilities:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-protobuf" data-lang="protobuf"><span style="display:flex;"><span>data_type<span style="color:#f92672">:</span> TYPE_FP32<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>dims<span style="color:#f92672">:</span> [ <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span> ]<span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Think about for a moment how can we use this feature of <code>-1</code> size for a JSON case. For impatient readers here is the full listing of <code>config.pbtxt</code> file for <code>echo-json</code> model:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-protobuf" data-lang="protobuf"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span> config.pbtxt<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>name<span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;echo-json&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>max_batch_size<span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>backend<span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;python&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>input [<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>    {<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>        name<span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;config:json&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>        data_type<span style="color:#f92672">:</span> TYPE_UINT8<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>        dims<span style="color:#f92672">:</span> [ <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> ]<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>    }<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>]<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>output [<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>    {<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>        name<span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;response:json&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>        data_type<span style="color:#f92672">:</span> TYPE_UINT8<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>        dims<span style="color:#f92672">:</span> [ <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> ]<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>    }<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>]<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>instance_group [<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>    {<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>      count<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>      kind<span style="color:#f92672">:</span> KIND_CPU<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>    }<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>]<span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Using <code>-1</code> in the shape of a tensor in the <code>config.pbtxt</code> file allows you to handle input and output data where the size is not fixed, which is exactly the case with a JSON object. Since a JSON can vary in size, you need a way to tell Triton to accept a variable-length byte array.</p>
<p>Here&rsquo;s how it works for a JSON:</p>
<ul>
<li>The entire JSON is converted into a <strong>single-dimensional array of bytes</strong>.</li>
<li>Since the number of bytes can change for each request, we use <code>[-1]</code> as the shape. This tells Triton to expect a single dimension of arbitrary size.</li>
</ul>
<p>This feature is crucial because it allows Triton to handle a variety of data types, not just traditional tensors with fixed shapes, as long as they can be represented as bytes. For the <code>echo-json</code> model, this lets us describe the input and output in a flexible way.</p>
<h3 id="the-modelpy-file">The <code>model.py</code> File</h3>
<p>Okay, we&rsquo;ve prepared the client and the <code>config.pbtxt</code> file for our model. Now it&rsquo;s time to build the <strong>model itself</strong>.</p>
<p>On the model side, the process is pretty straightforward:</p>
<ol>
<li>Receive the request.</li>
<li>Extract the tensor using its name.</li>
<li>Convert it into a NumPy array.</li>
<li>Decode the JSON data from that array.</li>
</ol>
<p>To create the response, we just reverse the process:</p>
<ol>
<li>Convert the JSON back into a NumPy array.</li>
<li>Wrap the NumPy array into a Triton tensor, making sure to use the correct data type and name.</li>
<li>Wrap the tensor in a Triton response object.</li>
</ol>
<p>It&rsquo;s a simple flow, and here&rsquo;s how it looks in the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># model.py</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Dict, List
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> triton_python_backend_utils <span style="color:#66d9ef">as</span> pb_utils
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TritonPythonModel</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">initialize</span>(self, args: Dict[str, str]) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Here in the `initialize()` we simply read &#34;config.pbtxt&#34; </span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># and get output tensor type</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>model_config <span style="color:#f92672">=</span> model_config <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(args[<span style="color:#e6db74">&#34;model_config&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        output_config <span style="color:#f92672">=</span> pb_utils<span style="color:#f92672">.</span>get_output_config_by_name(
</span></span><span style="display:flex;"><span>            model_config, <span style="color:#e6db74">&#34;response:json&#34;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>output_dtype <span style="color:#f92672">=</span> pb_utils<span style="color:#f92672">.</span>triton_string_to_numpy(output_config[<span style="color:#e6db74">&#34;data_type&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">execute</span>(
</span></span><span style="display:flex;"><span>        self, requests: <span style="color:#e6db74">&#34;List[pb_utils.InferenceRequest]&#34;</span>
</span></span><span style="display:flex;"><span>    ) <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;List[pb_utils.InferenceResponse]&#34;</span>:
</span></span><span style="display:flex;"><span>        responses <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> request <span style="color:#f92672">in</span> requests:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Get input by name</span>
</span></span><span style="display:flex;"><span>            input_tensor <span style="color:#f92672">=</span> pb_utils<span style="color:#f92672">.</span>get_input_tensor_by_name(request, <span style="color:#e6db74">&#34;config:json&#34;</span>)
</span></span><span style="display:flex;"><span>            input_arr: np<span style="color:#f92672">.</span>ndarray <span style="color:#f92672">=</span> input_tensor<span style="color:#f92672">.</span>as_numpy()
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Load JSON object from bytes we sent from the client</span>
</span></span><span style="display:flex;"><span>            input_json <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(input_arr<span style="color:#f92672">.</span>tobytes())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Got input json: `input_json`.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Process `input_json` here</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># [...]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Prepare response</span>
</span></span><span style="display:flex;"><span>            json_string <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(input_json)
</span></span><span style="display:flex;"><span>            outputs <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>frombuffer(json_string<span style="color:#f92672">.</span>encode(), dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>uint8)
</span></span><span style="display:flex;"><span>            out_tensor <span style="color:#f92672">=</span> pb_utils<span style="color:#f92672">.</span>Tensor(
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;response:json&#34;</span>, outputs<span style="color:#f92672">.</span>astype(self<span style="color:#f92672">.</span>output_dtype)
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            inference_response <span style="color:#f92672">=</span> pb_utils<span style="color:#f92672">.</span>InferenceResponse(output_tensors<span style="color:#f92672">=</span>[out_tensor])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            responses<span style="color:#f92672">.</span>append(inference_response)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> responses
</span></span></code></pre></div><h2 id="running-the-model">Running The Model</h2>
<p>On the previous post we&rsquo;ve already covered in details how to start the Triton server and make request to it. Start the Triton server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run --gpus<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --rm --net<span style="color:#f92672">=</span>host -v <span style="color:#e6db74">${</span>PWD<span style="color:#e6db74">}</span>/models:/models nvcr.io/nvidia/tritonserver:24.08-py3 tritonserver --model-repository<span style="color:#f92672">=</span>/models
</span></span></code></pre></div><p>Wait for a bit for Triton to start the model, and then make a request:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python client-echo-json.py
</span></span></code></pre></div><p>As the result, you shoul get the same JSON as you&rsquo;ve sent to the server.</p>
<p>For full code of the <code>echo-json</code> example, please visit <a href="https://github.com/yevhen-k/triton-tutorials" target="_blank">https://github.com/yevhen-k/triton-tutorials</a> and check the following files and directories:</p>
<ul>
<li><code>client-echo-json.py</code></li>
<li><code>models/echo-json</code></li>
</ul>
<h2 id="home-assignment">Home Assignment</h2>
<p>Here are some exercises to help you solidify what you&rsquo;ve learned. Feel free to experiment with the code we&rsquo;ve built and see what happens:</p>
<ol>
<li>Change data type: is it good idea to pass JSONs as float32?</li>
<li>Experiment with input/output shapes
<ol>
<li>What happens if you use a fixed, but arbitrary, dimension instead of <code>[-1]</code>?</li>
<li>If you know the exact length of your input and output tensors ahead of time, how can you hardcode them instead of using <code>[-1]</code>?</li>
</ol>
</li>
<li>Try modifying the JSON data within your <code>model.py</code> script before sending it back.</li>
<li>Is it possible to make a model that returns two JSONs? How would you implement that on both the server and client sides?</li>
</ol>
<h2 id="wrapping-it-up">Wrapping It Up</h2>
<p>Today, we figured out how to send and receive arbitrary data types to and from the Triton server, using JSONs as our example.</p>
<p>The core idea is to use a dimension size of <code>[-1]</code> in your <code>config.pbtxt</code> when you don&rsquo;t know the exact number of elements in a tensor ahead of time. Converting your data into a Triton tensor is much simpler than it sounds: you just need to turn the data into a <strong>byte array</strong> and then wrap those bytes in a <strong>NumPy array</strong>.</p>

  
  <hr>
<div class="footer">
    
    
    
    <p>
    This is a post in the <b><a href="/series/triton">Triton</a></b> series.
        <br>Other posts in this series:
        <ul class="series">
            
            
            
            <li>
                October 12, 2025 -
                
                    <a href="/series/triton/triton-serving-rf-detr-part-4/">Triton. Part 4. Serving RF-DETR</a>
                
            </li>
            
            <li>
                September 22, 2025 -
                
                    <a href="/series/triton/triton-working-with-images-part-3/">Triton. Part 3. Working with Images.</a>
                
            </li>
            
            <li>
                September 13, 2025 -
                
                    Triton. Part 2. Echo Json.
                
            </li>
            
            <li>
                September 9, 2025 -
                
                    <a href="/series/triton/triton-echo-tensor-part-1/">Triton. Part 1. Echo Tensor</a>
                
            </li>
            
            <li>
                September 9, 2025 -
                
                    <a href="/series/triton/triton-intro/">Triton Intro</a>
                
            </li>
            
        </ul>
    </p>
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#tldr-give-me-the-code">TL;DR: Give Me The Code</a></li>
    <li><a href="#is-triton-just-for-tensors">Is Triton Just for Tensors?</a></li>
    <li><a href="#its-all-just-bytes-really">It&rsquo;s All Just Bytes, Really</a>
      <ul>
        <li><a href="#the-client-side">The Client Side</a></li>
        <li><a href="#the-configpbtxt-file">The <code>config.pbtxt</code> File</a></li>
        <li><a href="#the-modelpy-file">The <code>model.py</code> File</a></li>
      </ul>
    </li>
    <li><a href="#running-the-model">Running The Model</a></li>
    <li><a href="#home-assignment">Home Assignment</a></li>
    <li><a href="#wrapping-it-up">Wrapping It Up</a></li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
